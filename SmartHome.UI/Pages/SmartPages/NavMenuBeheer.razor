@page "/smarthome/{SmartGuid}/beheer"
@using SmartHome.UI.Pages.Beheer;
@using SmartHome.Common.Models.Entities;
@inject IDeviceService deviceService;
@inherits SmartHomeGuidPage;

<MudTabs>
    <MudTabPanel Icon="@Icons.Material.Filled.Devices" Text="Devices" />
    <MudTabPanel Icon="@Icons.Material.Filled.SupervisedUserCircle" Text="Smart Users" BadgeData="1" BadgeColor="Color.Success" />
    <MudTabPanel Icon="@Icons.Material.Filled.AccessTime" Text="Routine"/>
</MudTabs>

@{
    List<Device> _deviceList = new List<Device>();
    _deviceList = deviceList;
}

<DeviceBeheer DevicesList="_deviceList"></DeviceBeheer>

@code {
    List<Device> deviceList = new List<Device>();

    protected override async Task OnInitializedAsync()
    {
        await LoadDevices();
    }

    private async Task LoadDevices()
    {
        var Devices = await deviceService.GetAllDevices(new());
        if (Devices.WasSuccess())
        {
            //Zet de apparaten in een lijst
            deviceList = Devices.Devices;
            StateHasChanged();
        }
    }
}
